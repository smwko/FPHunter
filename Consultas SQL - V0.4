SELECT * FROM MUNICIPIO, CENTRO, AREA, CURSO
WHERE MUNICIPIO.ID_MUNICIPIO = CENTRO.ID_MUNICIPIO
AND AREA.ID_AREA = CURSO.ID_AREA
AND CENTRO.ID_CENTRO = CURSO.ID_CENTRO
AND MUNICIPIO.NOMBRE_MUNICIPIO = 'MOSTOLES'
AND AREA.AREA = 'DESARROLLO'
AND CURSO.ESPECIALIDAD_CERTIFICADO = 'NO';

SELECT ROUND(((COUNT(CENTRO.ID_MUNICIPIO))*100)/(SELECT COUNT (ID_CURSO) FROM CURSO), 2) AS PORCENTAJE, MUNICIPIO.NOMBRE_MUNICIPIO AS 'MUNICIPIO'
FROM MUNICIPIO, CENTRO, CURSO
WHERE CENTRO.ID_MUNICIPIO = MUNICIPIO.ID_MUNICIPIO
AND CENTRO.ID_CENTRO = CURSO.ID_CENTRO
GROUP BY CENTRO.ID_MUNICIPIO;

SELECT COUNT(CENTRO.ID_MUNICIPIO), MUNICIPIO.NOMBRE_MUNICIPIO
FROM CURSO, MUNICIPIO, CENTRO
WHERE CENTRO.ID_CENTRO = CURSO.ID_CENTRO
AND CENTRO.ID_MUNICIPIO = MUNICIPIO.ID_MUNICIPIO
GROUP BY CENTRO.ID_MUNICIPIO;

SELECT (SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.ESPECIALIDAD_CERTIFICADO = 'SI')*100 / COUNT(ID_CURSO) AS 'CON CERTIFICADO'
FROM CURSO;

SELECT MUNICIPIO.NOMBRE_MUNICIPIO, COUNT(ID_CURSO) FROM CURSO, MUNICIPIO, CENTRO
WHERE CURSO.MODALIDAD = 'PRESENCIAL'
AND MUNICIPIO.ID_MUNICIPIO = CENTRO.ID_MUNICIPIO
AND CENTRO.ID_CENTRO = CURSO.ID_CENTRO
GROUP BY MUNICIPIO.NOMBRE_MUNICIPIO;

SELECT ROUND((SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.ESPECIALIDAD_CERTIFICADO = 'SI')*100 / COUNT(ID_CURSO), 2) AS '% CON CERTIFICADO',
ROUND((SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.ESPECIALIDAD_CERTIFICADO = 'NO')*100 / COUNT(ID_CURSO), 2) AS '% SIN CERTIFICADO',
ROUND((SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.MODALIDAD = 'PRESENCIAL')*100 / COUNT(ID_CURSO), 2) AS '% CURSO PRESENCIALES',
ROUND((SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.MODALIDAD = 'TELEFORMACION')*100 / COUNT(ID_CURSO), 2) AS '% CURSO TELEFORMACION',
ROUND(SUM(DURACION_FORMACION)/COUNT(ID_CURSO), 2) AS 'DURACION MEDIA DE FORMACION',
ROUND(SUM(DURACION_PRACTICAS)/COUNT(ID_CURSO), 2) AS 'DURACION MEDIA DE PRACTICAS'
FROM CURSO;

SELECT (SELECT COUNT(CURSO.ID_CURSO) FROM CURSO WHERE CURSO.MODALIDAD = 'TELEFORMACION'), MUNICIPIO.NOMBRE_MUNICIPIO
FROM CURSO, MUNICIPIO, CENTRO
WHERE CENTRO.ID_CENTRO = CURSO.ID_CENTRO
AND CENTRO.ID_MUNICIPIO = MUNICIPIO.ID_MUNICIPIO
GROUP BY MUNICIPIO.NOMBRE_MUNICIPIO;

